# Imbalanced data

## Resampling technique
![alt](https://raw.githubusercontent.com/rafjaa/machine_learning_fecib/master/src/static/img/resampling.png)



### Undersampling
#### **Fixed under-sampling**
##### ***Random Under-sampling***
* Trích xuất các quan sát ngẫu nhiên của lớp đa số cho đến khi đạt được một tỷ lệ cân bằng nhất định. Kỹ thuật này rất là đơn giản, không có bất kỳ giả định nào về dữ liệu
* Tuy nhiên, loại bỏ các quan sát khỏi lớp đa số, chúng ta đang loại bỏ những quan sát quan trọng, và khiến mô hình của chúng ta khó phân biệt các lớp hơn.

 

*`Code`*

```python
# import library
from imblearn.under_sampling import RandomUnderSampler

rus = RandomUnderSampler(random_state=42, replacement=True)# fit predictor and target variable
x_rus, y_rus = rus.fit_resample(x, y)

print('original dataset shape:', Counter(y))
print('Resample dataset shape', Counter(y_rus))
```
Dữ liệu ban đầu:

   ![alt](https://miro.medium.com/max/407/1*FEMM4LCxhfdlgHdDl1FHMA.png)

Sau khi randomundersampler:

   ![alt](https://miro.medium.com/max/399/1*_BwhcfxzpAc335mFi2HYGw.png)

##### ***NearMiss***
* Ỷ tưởng cơ bản là nó giữ lại nhưng quan sát gần hơn với các lớp thiếu số. 
* NearMiss được thiết kế để làm việc các tập dữ liệu văn bản, trong đó mỗi từ được biểu diễn phức tạp.


```python
#import thư viện
from imblearn.under_sampling import NearMiss
nm1 = NearMiss(
    sampling_strategy='auto',  # chỉ undersample lớp đa số
    version=1,
    n_neighbors=3,
    n_jobs=4)  # có 4 core trong máy

X_resampled, y_resampled = nm1.fit_resample(X, y)
```
Vẽ 2 biến (VarA,VarB) ban đầu:

![alt](https://lh3.googleusercontent.com/fife/AAWUweUmLApBk_ywVDqwT8vdL1TXUwAP4BRLXTMYoigwUGlgRwVJfD-VnjYA0eVni1AVhkv3cFSImFmA9Mo_gsIlnQxhYrB25IwETBOPR_MIIuQF8Flf9v9nai_obDZq3XFCvGwSonLlABZvMEQnoUXC-5wGnn236CXP0mFcvvrewjRPsxr4nEdAcAgc3_CCZFweChtzvN-qwd8bMoCKg4uX7YrPvvVzKZP3VHwDbj8GuQRL1VGLcoKzHQUt3Es05a9ME2ukJSQ8xApvhq2oy5qPh656qQhm8oAkYI4x8RkJchL2Rp-sQ9mx9LBnmWoC4Dja01MFVhyBIyQ02sIPSZxlO9iXSeuNNwfqGOHaw0c_hUWcZFzlUMRDPfMIugkOSTzSklCyvBkjIbelObDtadzq-zFU9Wt-SwrGAaOiHLGt3kRR01x-cZJ5hJeXZECj3PcnNdPESgedEdggHJwZdmBCWS9aW5iv9AHMiAtn0MAuaPTir872Q54gq7sg7M3MLGyACgJcttF1Bezcd0dW4_ZZqFOn97n-lktG4JTFYuYkMTVbhE-OQcwUWqmEakkXALcBbzzyGkKy5XPgmGtlm4wtO-LY9qEmyyDvILSqBnO_dFfs6DO85_jj8ATMNtf0cNTXoOKY8Vaqq_hKsVHhO1lK7YSAIS1My3dQj2RFXT91T9t5eO4DJdo3v25g9yd0uc-ukh-EMOcObZuDNzWQx1By4niYjhqFwmia7V64sGPZIVrGg0qOjsHvCCRqLzpcAWz8IxtgDgowKZN_1Cg3rPtxhMpCWlMNeUYmU2LNU9j2dRdqJlvG4mr59N_QWY1rqIvWh_x4ZMFOSMTo0JIoSlrPiCVud0U8eHgGzK8MvKmkeoh64Thc5YcJtd9qUDDe0CgNAzCroeK0hSWy80DXKA38t42Q9tj4ygyebwq4oSyaU1HSz_tfosQwvDosii_uiaC_CEQjc4VbudwIJOtOxEvVo8_CdtxtJySdaHPpNATRFmpjO-uGGStQjpeUYoBhQEGKHMm_Q2OsV9-zwvqR3O6mnU4aJWcyEJIKVaIn1d-klGq2Rmq-LLwPFJaZ3UfyRxKFGEJFQijEam_5l2bwOurt6PFotL1s6N7wWtiq45s7n-EIg8doe-zkkr4cLm1qhmBYNlFnLBcINoTQdwXzKrh8EdtFfqjnyS18nZoyV_XNYcgJzGeO28FponQOdmMFopG4p-z-Dbz1REPa3Flm13HpnhQo3x4lJ_lQ3UCfXBUaUrrZshg02he3YPfm45KcutA00-PwppjIYtQeVAiVxfjOuKO2ZJrJU-V0Sjor75biRde-vMrpR7l_QWdrs7hrJDm00l5FtFDtbAifuwC4aZk5CbtOgiaNCHr8Ou-ZjeRD14tz7YOx4wqUvGmPPfEHuIELA-9G4E4vrtsE8NfBdxAffZFFjWorrlVao0lD0xnwr-v3Elxl8zrR3Krgs7jlCP2Ta-YCu95ZZ96B46snBI5cNYBa4N1vBjY3jMlZuU2n4uAcLghseOR4CRGzlcymPepKYJXcZHCgmVN0ztDmFfE3I9FEaSnnOsq7z1_XJeqvBJCk0xStj9YcmCqMWP0-T1e0OHsPhk3h_7dccQTuZSmiXczNqNEkprIDUuMu9ilaauqDiASv5QG9-88MyofsQJJ6q6KJ7Dv20bl1gK7Fhmq9xjTUodqavepxu9ciDvBqY_0xuLy45CCC_o_egLbt_h9FH8Lknq1L_3Im0_2Ttip06vkItjOeMGpVdG9Yg4ata5lhjxsKAjHIsVpXTm-WYOobiIw0zVLtuNdx01rf0ksVylleZnwAyuOEevetnQ-GuwVmy6IGQgqSZNpyqzGJt7fyiiY8bwW7Sy6UX169lDDqnj4R_s8cXHCqx072Zmg0x-EQHjFPM7-EaFpS4RIN4vqp131cFG8b3lRZ3wjHoAog1xyLMlDPa5RkgQ_LPXIV3Er_vLvq21XXFBfxFxAkHGPKw0cKSgyHMlhlp0IwULxM4eiMx9juDaGOy4cp2kk-M0Ofcm3EGn_cJfOz6yCFpEuEGmAp_M_7nrVOIWFqqh0-2993-Ga55toeOaAZyM_6GhscerQXhMXioE57jMsg3N6Iu3Qi4tnSFxvXSoGghs2Z3OswRrJtba956qXzny8J_701d97wqOPaxLS0Jud_-XL9EoADp2h7yVfj384RW2OeDMGLrGYuGbhhVnk4dTVgL-PLSW_XJ940TPsGxz3wNB574kRyrM9gXC4uvcnQjZw2vZ1Jgjqhgl6XhVtudupWaoVh8InKiVX1Lp5NEpSahEMBNmhNO4plIybSwCp_TvU8zdPFOyEwgtlEmjCGL82AXBTwM3A_4dmee-S5egyYggH0HsQxEVwv17GSUsyCsNBX96kAAbk6n9lXY2gh-7n_BKV9KgIRwhdVrLzpiJNlm-9BaLb-csKNAv4wfMxJQbZZIG5bbcamaI9-ef-uMqnvT9pCmrB9fZuhuvmGmKrwoYX9qAhfhF093kfOrsynga68dpl5soim88eYlDeQkpMNka-Sa6N_uzd7ctTD4AC83p8NE5H6zMFuSUm59CBufK0xAjuqxgmePtpI7pS-tV0TmJsI5_jEeciv97lYXkVDeooBMLvrhzIlIK4XesbYjUEu-Hkc38-Svpy-3hc-sa2lATwhnvHDwh6LlIMY5rYhK0qqjfkKRh0cXlh9CFUzIdWJDm9SO4l1qk_2Zzuv5DxyvVzL-Awmm00ASOX9QK-ApowkJIr69GK8XBuNfOashSnUofRH_mCifzwLTFayTw5-UHEjq9PDtbLVFWXh2-5-X03noD_5XMW7hFP5ZD_e7mLoBtxoMBVr8O59-Xh4d5qnY3jKCDZNEVXwFER8Smaq-AGa1AML5xwRAG8blFc7rxTywf3dLJ1Yb8YOtTblX8-lWzG1FsJCLAdJt2LyfPeYYnzAppevZii7qUA7KqZ6FVECn85b-pHR0yqrGDBShDI36uZHhpo0Bb0PrPlD9pxANPvQv-crAaiMbyQSdGz_0dc_enli3jUA27_EM_IyXE9ojPOi2Gdhk796JEbjymBSobGsMwVagKwR4Cv4aBtmqn60H5cTW4aFS-BN7uNBqBTU06gFGLTyuodmD_RZgeVpDrKrtIFzACTG5v9x3ZmPUaRcrAOsF4rbzg4PbktjyGQuh9Rrh_EVgzUPDGNOY1YnqzN3r3VGidVn9zJG9xTUMyXk2aZXvtWXWF2dDxJpFqcSbLvDRnR67svDR4TRpBbYLGYnUceY6OQ3LBxr2htJnoVteSUA1m6bynTY-J-3izrYVtx7_TRKkTcoUJio4YcZqcrXipSCyxVyr7kb941hkUJCmLLO7L35Tq1CWlAa_hChZpE2QaMxZywfUXMpeiQoaurGnjT4sVTe9_hqdnfLBMFFRddcUO33XOEnEf1zfzSYZmmZbsvLmaDrmE6kN5CMQkem0MENkjMdBzG-yVHPGtOoyYMg5oMyodTRoYpgK7iadlHRbE8j0rVkYfT8JYu34GT7o-QmAeWuB2luQAGKof7W5ZSE4BjHHpF87nDcvGzsGUbG9wiRfXLFNuJzox5WPyyKQB6UfqfafS8X8WGY8ejyh-eoQolQ3cjgsjuFljPld-vpGdOytnGg55QLJZF1LFcL8QqmyiuMBrLNoP2gaGjyWh3t16klwQl-iZTy9KTEyu2XWL0IXH4cGBYu08V6-k7C1iKpj1zvUNnbr4VUZ3BCLZ7rC9xA8C6_hw=s452-w452-h310-no?authuser=0)


Sau khi NearMiss:

![alt](https://lh3.googleusercontent.com/fife/AAWUweWsix3q2tRy_RP7f8_uQsjKMaN8GhE9kGHpV1fr40EB6Rec8ygrHrvizYtZvYFyZ3gXgpJ4DNnmbG9ldtGA9JV8iheFQFLmRNZo5QfZDEkJ6rYOZ3mneLqXAxilvoahqRxT_lGuj-TrPSZ07w23sNlB3wrob2vkuc20InLmacHH5sBdlZjOEdLD6FR4iGr7XBVhMHkWxZ_MrsTCB3OeoczJ1CA-HCcf6nVWxja93UWYkRz_K1ob3mtndV4LmPQSG30iqhKA0KJfuX-Z4lA350HgiJ_Ie9J-WmNVwYHXwFpe2xx75oJmweSMjm8eBmjfnAV6adg75idcRiPQnyHNUesfuoK3tWyxYXmjhP8zaUdGA7pfLqbYPzhjp8vq5-_JNHKBuXfkA6ij5qShtPm_QFHhZu11ar9HJE9uNcOwT-rO5b-xYlg6uQLaPaByujy8DiOuiIO6XfcHsh4QBCmEHTg7nD3P2uFUcVIYzE6jlbJlA-Cq_3pnOrp3KN2L5Q49dHtXEYrAvdvBkZNZeEqZa6FfTrHN1JAmUKkTah_Fi2aoj9LO1upALG7r0iXNsPPEQQfNhbtkt8aZpm_ae49tHI77uLoPXJeXyYGxd4nVbbm9fE871TUgjEeGybjQlY9en_6Gv86-lbK3bKYaHUP1h5f_8nTarceiehrzNRFhvAyQXCX55usf3NNRrTUChFQWF7eSipzvwEiu3a3zSIyfxsk9kUvCBeN6mvpZPLkbX6Z-CdbCiPxvWMhpIVxcQzyEGEfLwOA7kE2gBoMO2VEMBn1uOAL6QYbAXcRNX8YEH_9xq4dRgXQyQRLLc0im8rLmTDnfV_kuIrZSSHhj7vvxuqXsBizpu65yPuTSoctyPm8KKSjuk0XA_OlTkyg7-fCWhsjauwsS2sKzM93EEXYAynw8wztBDxGzNphGEsWixVKjzys1wJpd-j5SVaSXGQ_-8uU7CrENg6IOp29NM6KbLKM2YQDAGnbzN-C7fGU5vQSMphckgmGDhJnb57COYIFczN-1fY_iBf7kAfkG-Qx8T2cW1xujUR0tEsNxe45IVpbJEF47hVLGbe4BEESDe166XdxuH2hdykjeNbfKcgflaPPm9sVZGsWMeauQ28Oo8cGO26arM3UyIkUMOZMjPbTejXouTddc4m4m9Ghwd-uQqNULYoUnEyXy_Z6_K6yET0DZTCc638su4zMxnJxctclIxOd7m4ciAH41FbibIHV2PlvJeVIDJ_idbCsHwHNXDpimbdyWz9BoAW_hQy-3PP34563pfnQQittIXZUfaXBbEbumUINToTVZqc0gNMdc25_WJKHx6QUnLk9YylS8BDqs5TbAjvi-kuXqZlc8l65IRrNzcIoXHuLbpxm3xRrKo3Mb6yobZzYNRprlTAjnLE-JgUw9kZISL8e5gYroJAlRYIQ7v5vxyzKuTPu2JTE11eWtYZzk66-Z8XInNV6GLWzN8WyTz7pPMn48qobktPo-07Srncn83KHKh2Lk0CGYKm_DWFhCYvtFzjQeSAUxYpN0-np0kKX2aF7_wKaBvkF5HC-Iv9uN_ohwCetH-fki-YaLzW5C0GkLbkjocS-lN5xQmqpqojo5i2XYecLmnOF9YNevaSYGmbFCuoiBF_B11EyVpntqD2vnD-iaf19pCZHxMsX31tQHbYwEg6sq-2EZ2grY0pVf1zG12ogHR3PTbL0LJiJLAoybTVMk2P-QQX2KFuQg_niSAm7BCdR5bR8Gb7qwu8mJNDEaYTz2deU4ixT3iL9LbHl2jmJnTXKK4KwSsxsGvL7y1uFqItlu_PMv_YoDZL6BkSkQ4jly-8PeegELHoKQJT8MbPiRs9weQ7e2_zz6EuEXEJR8W66YEfOhLbrASj7E08W75p35pCgr1uRf4ofCjk9G1SoJmMW6_2O-XPJu3V9NC3RhKh9MToaxDa3njts43NBTtXzT9TolVUFJlGwh0Ba1dVOxADUWvijTPq0HQ3Kisu0kRr4TF_pjRbk9wtc20-zXqv_xwEcjoOeRIRUEbr2efOPygqBDSeFzUycf8dFbNW-MT5HzxsBh9WO3QpIwiBJVvbiJLePdJ2pwMds5JIeEVIYcx1uVhCbk89k8HFS-VxSG2aoGwfkwMOLlJMtU_nhD2FPTIOa2z3Bf9MWhvYAVlV9U6kktS8XrQsE1w9T_qjEDzahw7oCeU4nWIvksYNAh5VuxjUt6MUYeBMNUh5PVA_na2SdBUi0eIPXbIkenlTpJcVe4B-KWr0Y1NYYZTGd7pug8zcFTs2_aQnVV1qIneRbzxjVk3qron6_57oNy0NLbjdBWXeGUsXCx-PqwwtVDoHnJZOL8Fzd9syRNkp-6Ms84g_P4vgXGcNhB99SzJq_2Gl7p8ffBtJGG5yj5hPbtoAJbMgz9jMEvgQN2RmGczFmujCCV9zJe8fgm5msNESLr18aXVnHQ-hNRNUaXicqxWtW8vJIRF01BtaRx_IRzaBHebaDxax87_EOfzoMLlvvDr0li3Wmw1e3nCV86YANTD2x4xUKJmTuMfZAbyfbbtd4VgIeWqvKLI_hwimYcUOQBH8p84oszOCY1ekvGSnKvtMCv8D7qSD_eLBlS9XhSVz2jDv-KOGKIqxysI2ObnepAyAv7eXy7dlJcMtbAy3ckHq9hX-wSsV4Jt1jAm1VNUYNu5uZrFUYA3N9qK47uGm1OKS6bqcNif-5zzZit7-cSYkNZqDSRVPyv9aJdx_Hf0ANsRJ7QcRphTMEFyFfTix5U1gSLOJdIxJdzyTsoKzhR-71LC-ZDBES9PVx_m89TTPnzXDGJ94KGPu34_w4O0zdXpgKdrOtF2bjL9N1Z-LVc4ocW2T1VTr9RqEq_5DRiBDZP6zlrCMRKKEnNyqHHKrKSxg-tLxsaMNNn7vf0L_gLmV_74J1ig8bVsM7YLVW8NOWojSDxfKeJNcEyQv414lEXB8Cv7Lj6WrEtWxsVQwuW5UCpazqJl6zjAxl0QqQa8Cp53_ke1BP7JajZoCb5KdLLEXekln8jIfY7wbs-2h4Df6wAqs8FMoxW8Wp5IEmko7KWAjj-9eitsW0Wxs7EyVN1WMtWcLO-saMj30N6Ny9sUFYw8Usz5muTiGd2eZ8ujkawp4XKogwAyoB32doKaxqAAw-mq8sW9E9LEuTgmDasAqSAJt8WPGSVmH2RhFxvBhK-d6boSsUhngIE8UoBez1kraddGxZRf_nX4Znj7BpIqYvrNKVRrv3iQ2aaKwhc2V7HSOyi0WOCjl8goSzGOB2DLPSHLxVOmvAIGQ3IppDZ8-Kk_Oet0EUyX_y8kfQQt436jchi6lEpaFjfp9IahOADH9WWizZkip7SQVNkLa7UG6b8VF64XDqUBLwzsBcMsTpW0mmT5GKWwS8VUdsWUNjHTjoXABGbeJe58QX--TTYrOEKOpTq4egt1iEmstWQ_ydHLwRBd2Mx466Tt_6YM7JOZ3Ea6fNxCQz0G6fbtNHtMVUmqcIX8vd_c_65uAYe1qcBKppyG8DiAlJPRt1LlBklDbGyo_l_sOK7ACTzfk0HaTwOk4mTf0TcBoZO2kY6Wq2I_48VF0ygMLUOu5RBrQYdO-7gzS70RmW0jfrXjFAcotk5ZV9cMrHOVhwne89fQ1_r2wKsZIUp0iecBdEgV0axVpsysVcHpDPybAWkqkCFDhxA-xrhQaykuvf5t5sOPGJ-qRHPX9Oml1oW9czEqTwT95H1f_4GaG5XQSnxe3k-pA=s473-w473-h317-no?authuser=0)

##### ***Instance Hardness***
* Là một phép đo độ khó để phân loại trường hơp hoặc quan sát một cách chính xác.
* Instance hardness(Xác xuất phân loại sai): một quan sát thuộc 2 điều
    * Thuật toán dùng để mô hình hóa nhiệm vụ
    * Mối quan hệ quan sát với các quan sát trong tập dữ liệu
* Phép đo instance hardness bằng một trừ đi xác xuất của lớp đa số, thể hiện của một quan sát bị phân loại sai 

*`Code`*
```python
# import library
from imblearn.under_sampling import InstanceHardnessThreshold
from sklearn.ensemble import RandomForestClassifier

tf = RandomForestClassifier(n_estimators=100, random_state=39, max_depth=3, n_jobs=4)

iht = InstanceHardnessThreshold(estimator = tf, sampling_strategy = 'auto',random_state = 0)

x_resampled, y_resampled = iht.fit_resample(x, y)

print('original dataset shape:', Counter(y))
print('Resample dataset shape', Counter(y_rus))
```
Trước khi InstancerHardness

![alt](https://lh3.googleusercontent.com/cZUJkbOqBt41610kr9cbIbcaKNw25CJwpMloJNETy9BFcUcml9xSycZQCU82W6RisqBm4yh5Wl0ClOtwLPb8n_q8XV2zS93tM-u0F6uuaMBdVoXmM4q7Hax4oGKONsrMLLJ2PS9Y78xppAK_5JZqgqo-Ebync7zD6uQfaOBPNe1bcL346EBRHriSbe65k9qDWRuIvSzjvaWvgL64W4T19T_-U5mQ3woiqtlVH1WkyiEu3M43g2mBLYitBtR1ICTc5sWOyxyR7jfLilCvT2jF_JJXVUsANVeZRxAL_ddTJtJrmVPHu1WtKQ0AAermmeWxaov28KjeUYOKu-h_YPjrKhYLSCKg1QcMAOGn-tmDpH6xvneUsF9zzygrHUvtGe7-AICDc2P_v0lP78cLDmqS924i82s2OyOAs0ansl8GdCj0h_kHbn2VoDwO1TP2kylR9BbZHUOQgPxKlbTvrJOUAAxvaxaPk75uGMHaFoGxZN31VgQ_fzBzkjhBx9WsOYiP3YAWXsr2d2pnG0XTEv3DYM9_FnIMmSEeYtFuuWDUC1b8YZiNwQZNFL-k0qz0kQF7Nv_C2PIXxom328f_se8-uJa885Yz9JM1uXhsacbb-p2rzfwPFtgqkAi92I6CRmDOfsWdCxFPQp_1ybG-sknpqBmh3EizFjF43KaTmHe0lg8JoUTWunVz20A3PHWZtsciigiehBRk3pV3tJWheXrGqD4=w470-h306-no?authuser=0)

Sau khi InstancerHardness

![alt](https://lh3.googleusercontent.com/_ETaPyP01Rm_ZtvIn-yv8aoCA33v6c1TgAh2h-qiR2LGJ72vQmiEgEbrZLsEK0no3YcxKNAB_Pzj7NinKGsubbL87HodhLaiS7W58us7GzKrlhp4Ql_2bdrFM4XbugFuXigp0pYApqgmESWi8OOntzg9tGiuGtMFn7F1RsWjO1n-57uL3fTuWD6IZq-i-ICpYJ3om-_ShMwZyaW-sUf4Jygy0jO_WYWVI6VVd_2AtoqRhm8ULFZb6JVaI-kbo74IIV9mgFfQ-beRkTuWksQcwYNE0fgvfJln0N6QKMmqDIhuaEyHtjbzKFJzlieAiy449-4OyDbJQOqD64Q7DLh8qpxZrZnknWMMQzqr51siNMmrCzwB0C9KrGPUdoy-k35j1W-agE4TTv9i7dZETOBCWAS9f90HzFYaX4_VvIf7irzw2UGg5ygpFnZO5v-UX7GdtGRowCp4sRQxcjPUS79I7F1RHHnyMtZJ2Ox9oRQlX2Bf-VLXogUdLN35RbrXT3642zv-G-fx3PPNbVVLBmK-8RfAjxnsZR9AgD93LFs3AdTL5pqFSSWXSpacWtuvvRiRFyFKi2U047kNi6ZbyNEKJcnXsIqwcvuI44qQxsKBsHduCEwce-r21uQoYrVCpLC8h5w4Tg5sO-OlWNveb3-Vncd5AgZqtRbz1nXqg2NwhVzMP5za8zJ_vnpQ8EKNrZ6y96yUMN8VdQzrtypPCSHnJwI=w484-h305-no?authuser=0)


#### **Clean under-sampling**
##### ***Tomek links***

* Nếu 2 mẫu trong tập dữ liệu là nearest neighbour của nhau và từ các lớp khác nhau thì chúng là các tomek link. Vậy nếu một quan sát của lớp đa số trong giống với một quan sát thiếu số thì đó là tomek link.

* Tomek's link tồn tại nếu hai mẫu là hàng xóm gần nhất của nhau

* Trong quy trình loại bỏ, chúng ta có thể chỉ loại bỏ các mẫu đa số trong các cặp Tomek Link, hoặc loại cả cặp mẫu. 

* Với Tomek Link, bằng cách loại bỏ nhiễu, chúng ta đang ngăn thuật toán máy học khỏi các trường hợp thực sự khó phân loại, và do đó bằng cách loại bỏ nhiễu, chúng ta có thể cải thiện chất lượng thuật toán. 


 
![alt](https://miro.medium.com/max/700/1*KxFmI15rxhvKRVl-febp-Q.png)

*`Code`*

```python
# import library
from imblearn.over_sampling import TomekLinks

tl =  TomekLinks(sampling_strategy = "majority")

x_tl,y_tl = tl.fit_resample(X_train,y_train)

print('original dataset shape:', Counter(y_train))
print('Resample dataset shape', Counter(y_tl))
```

Trước khi tomeklink

![alt](https://lh3.googleusercontent.com/vUekZlwyvkNJIolL7llUJ4KqDBsl8pwgMeXqGBYQpH3rzaOJWmtmX1DKOmAccCMVkj8-4o2EQI3MY03gFBPPmHIYvqnFaA0z3foGM-RruPLA4zf0MZUtPPyaetkTAisRDLUkPBZQhbsJ5ZnGHcKfSuWnD1W24tngXs6pXVUZBaz7TbhF8onEQATQhprBAb-wPMr4swOPGTj3fZvt_fr8jxk2FS71moLLq5XrUIrPu-FYiIx0ZagAZMgI_A5xrr0KhRg3W_eLnUhyYLxqwyLsRnGIxYlvVvZyWwA8OmATA0Vv_Nlm2hG0IpBIizXUU0c8UJQSFRiQqt-GBxk_YoLqOAvRyo-q6237BG97cTB0ruHzGhHnNpjYHq632EYKx7n6wDdIQeks9f3reWPOn9RxXH_ZG59Pjo9s_9Mwne3nprVK-cK1No-lbD9swpwi2mzdJgcoOmj8VPjxMNqECk_ehpCxJnwUPQySB-s3WumNzjrYrmu3iL3c8gIgcS5ZtI1U67HRY76MZw1qsoGEomu9NOkRTuRQzfZ1_xP9rPd5_Tf88KvXSmnxlg6ojhhKu6tBtFTsMu1v0cYRNNRIuF5Gej8rRqyIuUmmkDP6nCkoytQN0rxz8tx0bM-m3b2TYAeCshl1C-Hj94TbZF8DH1eGNuZhWSVBf3seyWliLqLt63A3grkQdIHTIltnopkK7aRi9mZ2hyKGTrV7yBKeDRdb8WE=w469-h307-no?authuser=0)


Sau khi TomekLink

![alt](https://lh3.googleusercontent.com/DYcMyFbWHgSy_5FWW4v8AEybQjVFgOKeHtl2wOve2Ryu8UGVJ5Fl7NrbkY-XwHJILCoZ46ja_Q-AaRXPU-4BIr3j_eP9Vwyn-DOrT0B10b9UEq1pFe2S2v_iimT4u7RJIyw0sER389Q6fAGnf09JW_ktROP0qfnNHGcdXDpG7-kZUzO4dSRm5qQ3-NQdc0qnsBxxdG1EuSw0yaugYbGezvbHJ-SdSQec5bpexN6xaE496h3RoPSt3MVRPn-5uu5tT_wVpXQa-Vouq9QSYcbaYJShNC5lAMr2KCFXdzC5-C9gIhWaeAwfSezUyPNWCszQQa5-I4yXS2rr-pMiN5GQrPh8byOn8f_kO5RTvKFIcZpLuTPMCq7JZxxsAH4sUwNuvnNp8RDL8_6ByhUPKhA71JuHdB7P91i8QmEgimFnLu7HSse0BOHAypR-nJHXaIkrFTCf5lvdedn1HFqgFbkzszyzCWZToMjqkajyZox__k7mvzEE_TAh2gQep_0B4XmSVnzEmKt1mIIoI6hAXGr97LZRF_Qc_Qd_qY5ui3TeNteUq1behxhidSzpiOuu8SyOO_YbqnHJhSmSBfixlhjHuMrjPdaueA0Hy6PCVxjMOrQIbsdS9Wc05l-9VXkQMAXUVoM6BLFQXgvxmWE33lYtwJNO-s-q0le1ah9kUWe6XVU7ROCGEVhqGTdjJu5kJBLZISV68ylgbeWpZdBc_ijU4eU=w455-h301-no?authuser=0)



### Oversampling





[Một số bài viết rất hay](https://towardsdatascience.com/handling-imbalanced-datasets-in-machine-learning-7a0e84220f28)